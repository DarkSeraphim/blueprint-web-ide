{"version":3,"names":[],"sources":["DrawingConnection.svelte"],"sourcesContent":["<script lang=\"ts\">;\n;\nimport { derived, get, readable, writable } from \"svelte/store\";\n;\nimport Connection from \"./Connection.svelte\";\nexport let connection;\nexport let scaling = 1;\nexport let offsetBB;\nconst mousePos = writable({ x: 0, y: 0 });\n// TODO Global Point Size\nconst pointOffsetX = 8;\nconst pointOffsetY = 10;\nfunction handleMouseMove(event) {\n    mousePos.set({\n        x: event.pageX,\n        y: event.pageY,\n    });\n}\nconst bounds = derived([connection, mousePos], ([$connection, $mousePos]) => {\n    if (!$connection || !$mousePos) {\n        return {\n            x: 0,\n            y: 0,\n            width: 0,\n            height: 0,\n            swap: false,\n        };\n    }\n    let left = $mousePos.x || Number.MAX_SAFE_INTEGER;\n    let right = $mousePos.x;\n    let top = $mousePos.y || Number.MAX_SAFE_INTEGER;\n    let bottom = $mousePos.y;\n    let swap = false;\n    if ($connection.sourceTile) {\n        // TODO Remove cast on svelte version >= 3.30\n        const sourceTile = get($connection.sourceTile.tile);\n        const sourceBounds = sourceTile.metadata.pinComponents[$connection.sourceTile.pin.name].getBoundingClientRect();\n        const x = sourceBounds.x;\n        const y = sourceBounds.y;\n        left = Math.min(left, x);\n        right = Math.max(right, x);\n        top = Math.min(top, y);\n        bottom = Math.max(bottom, y);\n        swap = !((left !== x && top !== y) || (right !== x && bottom !== y));\n    }\n    if ($connection.targetTile) {\n        // TODO Remove cast on svelte version >= 3.30\n        const targetTile = get($connection.targetTile.tile);\n        const targetBounds = targetTile.metadata.pinComponents[$connection.targetTile.pin.name].getBoundingClientRect();\n        const x = targetBounds.x;\n        const y = targetBounds.y;\n        left = Math.min(left, x);\n        right = Math.max(right, x);\n        top = Math.min(top, y);\n        bottom = Math.max(bottom, y);\n        swap = !((left !== x && top !== y) || (right !== x && bottom !== y));\n    }\n    left -= offsetBB.x;\n    right -= offsetBB.x;\n    top -= offsetBB.y;\n    bottom -= offsetBB.y;\n    left /= scaling;\n    right /= scaling;\n    top /= scaling;\n    bottom /= scaling;\n    // TODO Fix zoom scaling for point offsets\n    left += pointOffsetX;\n    right += pointOffsetX;\n    top += pointOffsetY;\n    bottom += pointOffsetY;\n    return {\n        x: left,\n        y: top,\n        width: right - left,\n        height: bottom - top,\n        swap,\n    };\n});\n</script>\n\n<svelte:window on:mousemove={handleMouseMove} />\n\n<Connection {bounds} />\n"],"mappings":"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"}